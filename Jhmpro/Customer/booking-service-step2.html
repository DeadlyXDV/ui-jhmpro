<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pilih Layanan - JHMPRO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              "primary-blue": "#1E3A8A",
              "secondary-blue": "#3B82F6",
              "light-blue": "#EFF6FF",
              "success-green": "#10B981",
              "warning-orange": "#F59E0B",
              "danger-red": "#EF4444",
              "gray-primary": "#374151",
              "gray-secondary": "#6B7280",
              "gray-heading": "#1F2937",
              "gray-bg": "#F9FAFB",
            },
            fontFamily: {
              inter: ["Inter", "system-ui", "sans-serif"],
            },
          },
        },
      };
    </script>
  </head>
  <body class="font-inter bg-gray-bg">
    <!-- Header -->
    <header class="bg-white shadow-sm">
      <nav class="container mx-auto px-4 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <div class="flex items-center space-x-4">
            <a
              href="#"
              onclick="logoutUser(); return false;"
              class="w-8 h-8 bg-primary-blue rounded-lg flex items-center justify-center"
            >
              <span class="text-white font-bold text-sm">JH</span>
            </a>
            <span class="font-bold text-lg text-gray-heading">JHMPRO</span>
          </div>
          <div class="flex items-center space-x-4">
            <a
              href="dashboard-customer.html"
              class="text-secondary-blue hover:text-primary-blue"
              >Dashboard</a
            >
            <div class="relative">
              <button
                id="profile-dropdown"
                class="flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-colors duration-200"
              >
                <img
                  src="https://via.placeholder.com/32x32"
                  alt="User"
                  class="w-8 h-8 rounded-full"
                />
                <span class="text-sm font-medium text-gray-primary"
                  >John Doe</span
                >
                <i class="fas fa-chevron-down text-gray-400 text-xs"></i>
              </button>

              <!-- Dropdown Menu -->
              <div
                id="profile-menu"
                class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 hidden z-50"
              >
                <div class="py-2">
                  <a
                    href="#"
                    class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200"
                  >
                    <i class="fas fa-user text-gray-400 mr-3"></i>
                    Profil
                  </a>
                  <a
                    href="#"
                    class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200"
                  >
                    <i class="fas fa-cog text-gray-400 mr-3"></i>
                    Pengaturan
                  </a>
                  <hr class="my-2 border-gray-200" />
                  <a
                    href="#"
                    onclick="logoutUser(); return false;"
                    class="flex items-center px-4 py-2 text-sm text-danger-red hover:bg-red-50 transition-colors duration-200"
                  >
                    <i class="fas fa-sign-out-alt text-danger-red mr-3"></i>
                    Keluar
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <div class="container mx-auto px-4 lg:px-8 py-8">
      <!-- Progress Steps -->
      <div class="mb-8">
        <div class="flex items-center justify-between max-w-4xl mx-auto">
          <!-- Step 1 -->
          <div class="flex items-center">
            <div
              class="w-10 h-10 bg-success-green rounded-full flex items-center justify-center text-white font-semibold"
            >
              <i class="fas fa-check text-sm"></i>
            </div>
            <span class="ml-3 text-success-green font-medium">Info Motor</span>
          </div>
          <div class="flex-1 h-1 bg-success-green mx-4"></div>

          <!-- Step 2 -->
          <div class="flex items-center">
            <div
              class="w-10 h-10 bg-primary-blue rounded-full flex items-center justify-center text-white font-semibold"
            >
              2
            </div>
            <span class="ml-3 text-primary-blue font-medium"
              >Pilih Layanan</span
            >
          </div>
          <div class="flex-1 h-1 bg-gray-300 mx-4"></div>

          <!-- Step 3 -->
          <div class="flex items-center">
            <div
              class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-gray-600 font-semibold"
            >
              3
            </div>
            <span class="ml-3 text-gray-secondary font-medium">Jadwal</span>
          </div>
          <div class="flex-1 h-1 bg-gray-300 mx-4"></div>

          <!-- Step 4 -->
          <div class="flex items-center">
            <div
              class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center text-gray-600 font-semibold"
            >
              4
            </div>
            <span class="ml-3 text-gray-secondary font-medium">Konfirmasi</span>
          </div>
        </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Form Container -->
        <div class="lg:col-span-2">
          <div class="bg-white rounded-2xl p-10 shadow-md">
            <h2 class="text-2xl font-semibold text-gray-heading mb-8">
              Pilih Layanan Servis
            </h2>

            <!-- Service Categories -->
            <div class="space-y-6">
              <!-- Regular Service -->
              <div class="border border-gray-200 rounded-xl p-6">
                <h3 class="text-lg font-semibold text-gray-heading mb-4">
                  <i class="fas fa-wrench text-secondary-blue mr-2"></i>
                  Servis Rutin
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <label
                    class="service-option flex items-start p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-secondary-blue transition-colors duration-200"
                  >
                    <input
                      type="checkbox"
                      class="mt-1 mr-3 text-secondary-blue"
                      data-price="150000"
                      data-duration="90"
                    />
                    <div class="flex-1">
                      <h4 class="font-medium text-gray-heading">
                        Servis Rutin Ringan
                      </h4>
                      <p class="text-sm text-gray-secondary mb-2">
                        Pemeriksaan dasar, bersih filter udara, cek rem
                      </p>
                      <div class="flex justify-between items-center">
                        <span class="text-lg font-semibold text-primary-blue"
                          >Rp 150.000</span
                        >
                        <span class="text-sm text-gray-secondary"
                          >~1.5 jam</span
                        >
                      </div>
                    </div>
                  </label>

                  <label
                    class="service-option flex items-start p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-secondary-blue transition-colors duration-200"
                  >
                    <input
                      type="checkbox"
                      class="mt-1 mr-3 text-secondary-blue"
                      data-price="200000"
                      data-duration="120"
                    />
                    <div class="flex-1">
                      <h4 class="font-medium text-gray-heading">
                        Servis Rutin Lengkap
                      </h4>
                      <p class="text-sm text-gray-secondary mb-2">
                        Servis menyeluruh + tune up mesin
                      </p>
                      <div class="flex justify-between items-center">
                        <span class="text-lg font-semibold text-primary-blue"
                          >Rp 200.000</span
                        >
                        <span class="text-sm text-gray-secondary">~2 jam</span>
                      </div>
                    </div>
                  </label>
                </div>
              </div>

              <!-- Oil Change -->
              <div class="border border-gray-200 rounded-xl p-6">
                <h3 class="text-lg font-semibold text-gray-heading mb-4">
                  <i class="fas fa-oil-can text-warning-orange mr-2"></i>
                  Ganti Oli & Filter
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <label
                    class="service-option flex items-start p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-secondary-blue transition-colors duration-200"
                  >
                    <input
                      type="checkbox"
                      class="mt-1 mr-3 text-secondary-blue"
                      data-price="75000"
                      data-duration="30"
                    />
                    <div class="flex-1">
                      <h4 class="font-medium text-gray-heading">
                        Ganti Oli Mesin
                      </h4>
                      <p class="text-sm text-gray-secondary mb-2">
                        Oli mesin berkualitas tinggi (4L)
                      </p>
                      <div class="flex justify-between items-center">
                        <span class="text-lg font-semibold text-primary-blue"
                          >Rp 75.000</span
                        >
                        <span class="text-sm text-gray-secondary"
                          >~30 menit</span
                        >
                      </div>
                    </div>
                  </label>

                  <label
                    class="service-option flex items-start p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-secondary-blue transition-colors duration-200"
                  >
                    <input
                      type="checkbox"
                      class="mt-1 mr-3 text-secondary-blue"
                      data-price="25000"
                      data-duration="15"
                    />
                    <div class="flex-1">
                      <h4 class="font-medium text-gray-heading">
                        Ganti Filter Oli
                      </h4>
                      <p class="text-sm text-gray-secondary mb-2">
                        Filter oli berkualitas OEM
                      </p>
                      <div class="flex justify-between items-center">
                        <span class="text-lg font-semibold text-primary-blue"
                          >Rp 25.000</span
                        >
                        <span class="text-sm text-gray-secondary"
                          >~15 menit</span
                        >
                      </div>
                    </div>
                  </label>
                </div>
              </div>

              <!-- Engine Service -->
              <div class="border border-gray-200 rounded-xl p-6">
                <h3 class="text-lg font-semibold text-gray-heading mb-4">
                  <i class="fas fa-cogs text-danger-red mr-2"></i>
                  Servis Mesin
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <label
                    class="service-option flex items-start p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-secondary-blue transition-colors duration-200"
                  >
                    <input
                      type="checkbox"
                      class="mt-1 mr-3 text-secondary-blue"
                      data-price="300000"
                      data-duration="180"
                    />
                    <div class="flex-1">
                      <h4 class="font-medium text-gray-heading">
                        Tune Up Mesin
                      </h4>
                      <p class="text-sm text-gray-secondary mb-2">
                        Pembersihan karburator, setting klep
                      </p>
                      <div class="flex justify-between items-center">
                        <span class="text-lg font-semibold text-primary-blue"
                          >Rp 300.000</span
                        >
                        <span class="text-sm text-gray-secondary">~3 jam</span>
                      </div>
                    </div>
                  </label>

                  <label
                    class="service-option flex items-start p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-secondary-blue transition-colors duration-200"
                  >
                    <input
                      type="checkbox"
                      class="mt-1 mr-3 text-secondary-blue"
                      data-price="150000"
                      data-duration="90"
                    />
                    <div class="flex-1">
                      <h4 class="font-medium text-gray-heading">
                        Cleaning CVT
                      </h4>
                      <p class="text-sm text-gray-secondary mb-2">
                        Khusus motor matic, pembersihan CVT
                      </p>
                      <div class="flex justify-between items-center">
                        <span class="text-lg font-semibold text-primary-blue"
                          >Rp 150.000</span
                        >
                        <span class="text-sm text-gray-secondary"
                          >~1.5 jam</span
                        >
                      </div>
                    </div>
                  </label>
                </div>
              </div>

              <!-- Brake Service -->
              <div class="border border-gray-200 rounded-xl p-6">
                <h3 class="text-lg font-semibold text-gray-heading mb-4">
                  <i class="fas fa-circle-notch text-success-green mr-2"></i>
                  Servis Rem
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <label
                    class="service-option flex items-start p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-secondary-blue transition-colors duration-200"
                  >
                    <input
                      type="checkbox"
                      class="mt-1 mr-3 text-secondary-blue"
                      data-price="100000"
                      data-duration="60"
                    />
                    <div class="flex-1">
                      <h4 class="font-medium text-gray-heading">
                        Ganti Kampas Rem
                      </h4>
                      <p class="text-sm text-gray-secondary mb-2">
                        Kampas rem depan dan belakang
                      </p>
                      <div class="flex justify-between items-center">
                        <span class="text-lg font-semibold text-primary-blue"
                          >Rp 100.000</span
                        >
                        <span class="text-sm text-gray-secondary">~1 jam</span>
                      </div>
                    </div>
                  </label>

                  <label
                    class="service-option flex items-start p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-secondary-blue transition-colors duration-200"
                  >
                    <input
                      type="checkbox"
                      class="mt-1 mr-3 text-secondary-blue"
                      data-price="50000"
                      data-duration="30"
                    />
                    <div class="flex-1">
                      <h4 class="font-medium text-gray-heading">Setting Rem</h4>
                      <p class="text-sm text-gray-secondary mb-2">
                        Penyetelan dan pembersihan sistem rem
                      </p>
                      <div class="flex justify-between items-center">
                        <span class="text-lg font-semibold text-primary-blue"
                          >Rp 50.000</span
                        >
                        <span class="text-sm text-gray-secondary"
                          >~30 menit</span
                        >
                      </div>
                    </div>
                  </label>
                </div>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-between pt-8">
              <a
                href="booking-service.html"
                class="px-8 py-3 border-2 border-gray-300 text-gray-primary rounded-lg hover:bg-gray-50 transition-colors duration-200 text-center"
              >
                Kembali
              </a>
              <button
                type="button"
                id="next-step"
                class="px-8 py-3 bg-primary-blue text-white rounded-lg hover:bg-blue-900 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                disabled
              >
                Lanjutkan
              </button>
            </div>
          </div>
        </div>

        <!-- Summary Sidebar -->
        <div class="lg:col-span-1">
          <div
            class="bg-gray-bg border border-gray-200 rounded-xl p-6 sticky top-8"
          >
            <h3 class="text-lg font-semibold text-gray-heading mb-4">
              Ringkasan Booking
            </h3>

            <!-- Vehicle Info -->
            <div class="space-y-3 mb-6">
              <div class="flex justify-between text-sm">
                <span class="text-gray-secondary">Motor:</span>
                <span class="text-gray-primary" id="vehicle-info"
                  >Honda Beat 2020</span
                >
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-gray-secondary">Nomor Polisi:</span>
                <span class="text-gray-primary" id="license-plate"
                  >B 1234 XYZ</span
                >
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-gray-secondary">Layanan:</span>
                <div
                  class="text-gray-primary text-right"
                  id="selected-services"
                >
                  <span class="text-gray-400">Belum dipilih</span>
                </div>
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-gray-secondary">Tanggal:</span>
                <span class="text-gray-primary">-</span>
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-gray-secondary">Waktu:</span>
                <span class="text-gray-primary">-</span>
              </div>
            </div>

            <div class="border-t border-gray-300 pt-4">
              <div class="flex justify-between text-sm mb-2">
                <span class="text-gray-secondary">Estimasi Biaya:</span>
                <span class="text-gray-primary" id="total-cost">Rp 0</span>
              </div>
              <div class="flex justify-between text-sm mb-2">
                <span class="text-gray-secondary">Estimasi Waktu:</span>
                <span class="text-gray-primary" id="total-duration"
                  >0 menit</span
                >
              </div>
              <div class="flex justify-between font-semibold text-lg">
                <span class="text-gray-heading">Total:</span>
                <span class="text-primary-blue" id="final-total">Rp 0</span>
              </div>
            </div>

            <!-- Selected Services Detail -->
            <div class="mt-6" id="service-details" style="display: none">
              <h4 class="text-sm font-medium text-gray-heading mb-3">
                Detail Layanan
              </h4>
              <div class="space-y-2 text-sm" id="service-list">
                <!-- Services will be populated here -->
              </div>
            </div>

            <!-- Info Box -->
            <div class="mt-6 p-4 bg-light-blue rounded-lg">
              <div class="flex items-start space-x-3">
                <i class="fas fa-info-circle text-secondary-blue mt-1"></i>
                <div>
                  <h4 class="text-sm font-medium text-gray-heading mb-1">
                    Informasi Penting
                  </h4>
                  <p class="text-xs text-gray-secondary">
                    • Harga yang ditampilkan adalah estimasi<br />
                    • Harga final akan dikonfirmasi setelah pemeriksaan<br />
                    • Booking dapat dibatalkan H-1
                  </p>
                </div>
              </div>
            </div>

            <!-- Contact Info -->
            <div class="mt-6 p-4 bg-white rounded-lg border">
              <h4 class="text-sm font-semibold text-gray-heading mb-3">
                Butuh Bantuan?
              </h4>
              <div class="space-y-2">
                <div class="flex items-center space-x-2 text-sm">
                  <i class="fas fa-phone text-secondary-blue"></i>
                  <span class="text-gray-primary">+62 21 1234 5678</span>
                </div>
                <div class="flex items-center space-x-2 text-sm">
                  <i class="fas fa-envelope text-secondary-blue"></i>
                  <span class="text-gray-primary">support@jhmpro.com</span>
                </div>
                <div class="flex items-center space-x-2 text-sm">
                  <i class="fab fa-whatsapp text-success-green"></i>
                  <span class="text-gray-primary">WhatsApp Support</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Service selection logic
      let selectedServices = [];
      let totalCost = 0;
      let totalDuration = 0;

      // Get vehicle info from localStorage (simulated data)
      function loadVehicleInfo() {
        // In a real app, this would come from previous step data
        const vehicleInfo =
          localStorage.getItem("vehicleInfo") || "Honda Beat 2020";
        const licensePlate =
          localStorage.getItem("licensePlate") || "B 1234 XYZ";

        document.getElementById("vehicle-info").textContent = vehicleInfo;
        document.getElementById("license-plate").textContent = licensePlate;
      }

      // Handle service selection
      document
        .querySelectorAll('.service-option input[type="checkbox"]')
        .forEach((checkbox) => {
          checkbox.addEventListener("change", function () {
            const label = this.closest(".service-option");
            const serviceName = label.querySelector("h4").textContent;
            const servicePrice = parseInt(this.dataset.price);
            const serviceDuration = parseInt(this.dataset.duration);

            if (this.checked) {
              // Add service
              selectedServices.push({
                name: serviceName,
                price: servicePrice,
                duration: serviceDuration,
              });
              label.classList.add("border-secondary-blue", "bg-light-blue");
            } else {
              // Remove service
              selectedServices = selectedServices.filter(
                (service) => service.name !== serviceName
              );
              label.classList.remove("border-secondary-blue", "bg-light-blue");
            }

            updateSummary();
          });
        });

      function updateSummary() {
        const servicesContainer = document.getElementById("selected-services");
        const serviceDetails = document.getElementById("service-details");
        const serviceList = document.getElementById("service-list");
        const nextButton = document.getElementById("next-step");

        if (selectedServices.length === 0) {
          servicesContainer.innerHTML =
            '<span class="text-gray-400">Belum dipilih</span>';
          serviceDetails.style.display = "none";
          nextButton.disabled = true;
          totalCost = 0;
          totalDuration = 0;
        } else {
          // Update selected services display
          const serviceNames = selectedServices
            .map((service) => service.name)
            .join(", ");
          servicesContainer.textContent =
            selectedServices.length > 2
              ? `${selectedServices.length} layanan dipilih`
              : serviceNames;

          // Show service details
          serviceDetails.style.display = "block";
          serviceList.innerHTML = selectedServices
            .map(
              (service) =>
                `<div class="flex justify-between">
              <span>${service.name}</span>
              <span>Rp ${service.price.toLocaleString("id-ID")}</span>
            </div>`
            )
            .join("");

          nextButton.disabled = false;

          // Calculate totals
          totalCost = selectedServices.reduce(
            (sum, service) => sum + service.price,
            0
          );
          totalDuration = selectedServices.reduce(
            (sum, service) => sum + service.duration,
            0
          );
        }

        // Update cost and duration display
        document.getElementById(
          "total-cost"
        ).textContent = `Rp ${totalCost.toLocaleString("id-ID")}`;
        document.getElementById(
          "final-total"
        ).textContent = `Rp ${totalCost.toLocaleString("id-ID")}`;

        // Format duration
        const hours = Math.floor(totalDuration / 60);
        const minutes = totalDuration % 60;
        let durationText = "";
        if (hours > 0) durationText += `${hours} jam `;
        if (minutes > 0) durationText += `${minutes} menit`;
        document.getElementById("total-duration").textContent =
          durationText || "0 menit";
      }

      // Next step handler
      document
        .getElementById("next-step")
        .addEventListener("click", function () {
          if (selectedServices.length === 0) {
            alert("Mohon pilih minimal satu layanan servis");
            return;
          }

          // Save selected services to localStorage
          localStorage.setItem(
            "selectedServices",
            JSON.stringify(selectedServices)
          );
          localStorage.setItem("totalCost", totalCost);
          localStorage.setItem("totalDuration", totalDuration);

          // Navigate to next step
          window.location.href = "booking-service-step3.html";
        });

      // Initialize
      loadVehicleInfo();

      // Profile dropdown functionality
      const profileDropdown = document.getElementById("profile-dropdown");
      const profileMenu = document.getElementById("profile-menu");

      function toggleProfileMenu() {
        profileMenu.classList.toggle("hidden");
      }

      function hideProfileMenu() {
        profileMenu.classList.add("hidden");
      }

      profileDropdown.addEventListener("click", (e) => {
        e.stopPropagation();
        toggleProfileMenu();
      });

      // Close dropdown when clicking outside
      document.addEventListener("click", (e) => {
        if (
          !profileDropdown.contains(e.target) &&
          !profileMenu.contains(e.target)
        ) {
          hideProfileMenu();
        }
      });

      // Close dropdown when pressing escape
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
          hideProfileMenu();
        }
      });
    </script>

    <!-- Navigation Enhancement Script -->
    <script src="../navigation.js"></script>
    <script src="../auth.js"></script>
  </body>
</html>
